# 四边形ROI选择器使用说明

## 🎯 功能简介

本项目已成功重构，新增了**不规则四边形ROI选择功能**，相比原来的矩形ROI选择，四边形ROI可以更精确地定义感兴趣区域。

## 🚀 快速开始

### 1. 编译项目
```bash
mkdir build
cd build
cmake ..
mingw32-make
```

### 2. 运行主程序
```bash
./point_laser.exe
```

### 3. 选择功能
程序启动后会显示菜单：
- **1. 矩形ROI** - 原有的矩形选择功能
- **2. 四边形ROI** - 🆕 新的四边形选择功能
- **3. 相机标定** - 相机标定功能

## 📐 四边形ROI使用步骤

### 选择四边形ROI
1. 运行主程序，选择选项 **2**
2. 在弹出的窗口中**点击4个点**来定义四边形
3. 按 **ESC键** 可以取消选择
4. 选择完成后会显示结果和保存选项
5. 可以点击图像测试点检测功能

### 操作提示
- 🖱️ **鼠标左键点击**：添加顶点
- 🖱️ **鼠标移动**：实时预览连线
- ⌨️ **ESC键**：取消选择
- 💾 **自动保存**：选择完成后自动保存到 `quad_roi.txt`

## 🧪 测试程序

运行测试程序查看示例：
```bash
./test_quad_roi.exe
```

测试程序功能：
- 加载已保存的四边形ROI文件
- 创建示例四边形ROI
- 演示点检测功能

## 📁 生成的文件

- `quad_roi.txt` - 四边形ROI配置文件
- `rect_roi.txt` - 矩形ROI配置文件
- `sample_quad_roi.txt` - 示例四边形ROI文件

## 🔧 技术特性

### 交互式选择
- ✅ 鼠标点击选择4个顶点
- ✅ 实时预览选择过程
- ✅ 支持ESC键取消
- ✅ 自动计算外接矩形

### 几何计算
- ✅ 点是否在四边形内的检测（射线法）
- ✅ 四边形绘制和可视化
- ✅ 外接矩形计算

### 文件操作
- ✅ 保存四边形ROI到文件
- ✅ 从文件加载四边形ROI
- ✅ 兼容原有矩形ROI文件格式

## 💡 使用技巧

1. **顶点顺序**：按顺时针或逆时针顺序点击顶点
2. **避免自交**：确保四边形不重叠
3. **点检测**：选择完成后可以点击图像任意位置测试点是否在四边形内
4. **文件管理**：ROI配置会自动保存，下次可以直接加载使用

## 🐛 故障排除

### 编译问题
- 确保OpenCV库路径正确
- 检查MinGW编译器版本兼容性

### 运行问题
- 确保图像文件路径正确
- 检查文件写入权限

### 选择问题
- 如果选择失败，按ESC重新开始
- 确保点击了4个不同的点

## 📞 支持

如有问题，请检查：
1. 编译是否成功
2. 图像文件是否存在
3. 文件路径是否正确
4. 是否有足够的文件写入权限

---

**🎉 恭喜！您现在可以使用更精确的四边形ROI选择功能了！** 